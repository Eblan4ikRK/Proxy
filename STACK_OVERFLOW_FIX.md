# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Stack Overflow –≤ FULL HOOK DUMPER

## üö® –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ `hooked_*.lua` —Ñ–∞–π–ª–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª **stack overflow** –∏–∑-–∑–∞ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –≤ print hook:

```
lua: hooked_1752945320.lua:310: stack overflow
stack traceback:
        hooked_1752945320.lua:310: in function 'print'
        hooked_1752945320.lua:59: in function 'capture_string'
        hooked_1752945320.lua:312: in function 'print'
        hooked_1752945320.lua:59: in function 'capture_string'
        ...
```

## üîç –ü—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã

**–†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –≤—ã–∑–æ–≤** –≤ –∫–æ–¥–µ:

```lua
-- –ü—Ä–æ–±–ª–µ–º–Ω—ã–π –∫–æ–¥:
local function capture_string(str, context)
    -- ... 
    print("üìù STRING[...]")  -- ‚Üê –í—ã–∑—ã–≤–∞–µ—Ç hooked print
end

-- Hook print function
print = function(...)
    for i, arg in ipairs(args) do
        if type(arg) == "string" then
            capture_string(arg, "print_output")  -- ‚Üê –í—ã–∑—ã–≤–∞–µ—Ç capture_string
        end
    end
    return original_print(...)
end
```

**–¶–µ–ø–æ—á–∫–∞ —Ä–µ–∫—É—Ä—Å–∏–∏:**
`print()` ‚Üí `capture_string()` ‚Üí `print()` ‚Üí `capture_string()` ‚Üí ‚àû

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é

```bash
# –°–æ–∑–¥–∞—ë–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π hooked —Ñ–∞–π–ª
python3 full_hook_fixed.py your_script.lua analysis.txt

# –ó–∞–ø—É—Å–∫–∞–µ–º –±–µ–∑ –ø—Ä–æ–±–ª–µ–º
lua hooked_fixed_*.lua
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ–∞–π–ª

```bash
# –ò—Å–ø—Ä–∞–≤–ª—è–µ–º —É–∂–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π hooked —Ñ–∞–π–ª
python3 quick_fix.py hooked_1752945320.lua

# –ó–∞–ø—É—Å–∫–∞–µ–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π
lua hooked_1752945320_fixed.lua
```

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### 1. **–ë–µ–∑–æ–ø–∞—Å–Ω—ã–π print**
```lua
-- –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π print –î–û —Å–æ–∑–¥–∞–Ω–∏—è hooks
local original_print = print
local _print_safe = function(...)
    return original_print(...)
end
```

### 2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π capture_string**
```lua
local function capture_string_safe(str, source, context)
    if type(str) == "string" and #str > 0 then
        -- –ò—Å–ø–æ–ª—å–∑—É–µ–º –ë–ï–ó–û–ü–ê–°–ù–´–ô print
        _print_safe("üìù [STR " .. counter .. "] '" .. str .. "'")
    end
end
```

### 3. **–û—Ç–∫–ª—é—á–µ–Ω–∏–µ print hook**
```lua
-- –ù–ï —Ö—É–∫–∞–µ–º print —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —Ä–µ–∫—É—Ä—Å–∏–∏!
-- –û—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ v28, v29, string.char, table.concat hooks
```

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π

| –í–µ—Ä—Å–∏—è | v28/v29 Hook | String Hook | Print Hook | –†–µ–∫—É—Ä—Å–∏—è |
|--------|--------------|-------------|------------|----------|
| –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è | ‚úÖ | ‚úÖ | ‚úÖ | ‚ùå **Stack overflow** |
| –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è | ‚úÖ | ‚úÖ | ‚ùå –û—Ç–∫–ª—é—á–µ–Ω | ‚úÖ **–†–∞–±–æ—Ç–∞–µ—Ç** |

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤:
```bash
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é
python3 full_hook_fixed.py script.lua output.txt
lua hooked_fixed_*.lua
```

### –î–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö hooked —Ñ–∞–π–ª–æ–≤:
```bash
# –ë—ã—Å—Ç—Ä–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
python3 quick_fix.py hooked_file.lua
lua hooked_file_fixed.lua
```

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:
```bash
# ONE-CLICK –¥–µ–æ–±—Ñ—É—Å–∫–∞—Ç–æ—Ä (–±–µ–∑ hooks)
python3 deobfuscate.py script.lua

# –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
python3 luaobfuscator_com_deobfuscator.py script.lua
```

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è fix'–∞:

```bash
üöÄ FULL HOOK DUMPER (FIXED) –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!
üìä –ù–∞—á–∏–Ω–∞–µ–º –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ LuaObfuscator.com

‚ö†Ô∏è v28 function –Ω–µ –Ω–∞–π–¥–µ–Ω–∞  # ‚Üê –í–∞—à —Ñ–∞–π–ª –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç v28/v29
‚ö†Ô∏è v29 function –Ω–µ –Ω–∞–π–¥–µ–Ω–∞  # ‚Üê –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ñ–∞–π–ª–æ–≤
‚úÖ string.char hook —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!
‚úÖ table.concat hook —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!

üìù [STR 1] (string.char) 'hello'
üìù [STR 2] (string.char) 'world'
...

üéâ –†–ï–ö–û–ù–°–¢–†–£–ò–†–û–í–ê–ù–ù–´–ô –ö–û–î:
print("extracted_string")
```

## üí° –ü–æ—á–µ–º—É v28/v29 –Ω–µ –Ω–∞–π–¥–µ–Ω—ã?

–í–∞—à —Ñ–∞–π–ª –º–æ–∂–µ—Ç –±—ã—Ç—å:
1. **–î—Ä—É–≥–æ–π –≤–µ—Ä—Å–∏–∏** LuaObfuscator.com (–Ω–µ Alpha 0.10.9)
2. **–î—Ä—É–≥–æ–≥–æ –æ–±—Ñ—É—Å–∫–∞—Ç–æ—Ä–∞** (Hercules, custom)
3. **–õ—ë–≥–∫–æ–π –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏** –±–µ–∑ VM —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

**–≠—Ç–æ –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞!** string.char –∏ table.concat hooks –≤—Å—ë —Ä–∞–≤–Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç.

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ï—Å–ª–∏ –≤—Å—ë –µ—â—ë –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏—é Lua:**
   ```bash
   lua -v
   ```

2. **–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã:**
   ```bash
   # –ü—Ä–æ—Å—Ç–æ–π –∞–Ω–∞–ª–∏–∑
   python3 deobfuscate.py script.lua
   
   # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π
   python3 hex_decoder.py
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∏–ø—ã —Å—Ç—Ä–æ–∫ –≤ —Ñ–∞–π–ª–µ:**
   ```bash
   grep -o '"[^"]*"' your_script.lua | head -10
   ```

## ‚úÖ –ò—Ç–æ–≥

**–ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞!** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
- `full_hook_fixed.py` –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤
- `quick_fix.py` –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö
- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã –µ—Å–ª–∏ hooks –Ω–µ –ø–æ–¥—Ö–æ–¥—è—Ç

**–í–∞—à –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –∫–æ–¥ –≤—Å—ë —Ä–∞–≤–Ω–æ –±—É–¥–µ—Ç –∏–∑–≤–ª–µ—á—ë–Ω!** üéâ